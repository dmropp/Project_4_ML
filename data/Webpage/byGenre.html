<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movie Genre Selector</title>
</head>
<body>

<h1>Movie Genre Selector</h1>

<label for="genreSelect">Select a Genre:</label>
<select id="genreSelect" onchange="displayMovies()">
    <!-- Options will be dynamically added here using JavaScript -->
</select>

<label for="secondGenreSelect">Select a Second Genre:</label>
<select id="secondGenreSelect" onchange="displayMovies()">
    <!-- Options will be dynamically added here using JavaScript -->
</select>

<div id="movieList">
    <!-- Movie list will be displayed here -->
</div>

<script src="movie_data.js"></script>
<script>
    // Extracting unique genres from the movie data
    var allGenres = getUniqueGenres(movieData);

    // Populating the first dropdown menu with genres
    var genreSelect = document.getElementById('genreSelect');
    allGenres.forEach(function (genre) {
        var option = document.createElement('option');
        option.value = genre;
        option.text = genre;
        genreSelect.add(option);
    });

    // Function to display movies based on the selected genre
    function displayMovies() {
        var selectedGenre = genreSelect.value;
        var secondGenreSelect = document.getElementById('secondGenreSelect');
        var movieListDiv = document.getElementById('movieList');

        // Clear second dropdown and movie list
        secondGenreSelect.innerHTML = "";
        movieListDiv.innerHTML = "";

        // If the first genre is selected, get movies and populate the second dropdown
        if (selectedGenre !== "") {
            var movies = getMoviesByGenre(movieData, selectedGenre);

            // Populate the second dropdown with genres from the selected movies
            var uniqueGenres = getUniqueGenres(getMoviesData(movieData, movies));
            var allOption = document.createElement('option');
            allOption.value = "";
            allOption.text = "All Genres";
            secondGenreSelect.add(allOption);

            uniqueGenres.forEach(function (genre) {
                var option = document.createElement('option');
                option.value = genre;
                option.text = genre;
                secondGenreSelect.add(option);
            });

            // Display movies based on the selected genres
            displayMoviesWithGenres();
        }
    }

    // Function to display movies based on both selected genres
    function displayMoviesWithGenres() {
        var selectedGenre = genreSelect.value;
        var selectedSecondGenre = secondGenreSelect.value;
        var movieListDiv = document.getElementById('movieList');

        var movies = [];

        if (selectedGenre !== "" && selectedSecondGenre === "") {
            movies = getMoviesByGenre(movieData, selectedGenre);
        } else if (selectedGenre !== "" && selectedSecondGenre !== "") {
            movies = getMoviesByGenres(movieData, [selectedGenre, selectedSecondGenre]);
        }

        movieListDiv.innerHTML = "<h2>Movies:</h2><ul>" + movies.join('</li><li>') + "</ul>";
    }

    // Function to get movies based on the selected genres
    function getMoviesByGenres(data, genres) {
        var movies = [];
        for (var i = 0; i < data.length; i++) {
            var movieGenres = data[i][1].split('|');
            if (genres.every(g => movieGenres.includes(g))) {
                movies.push(data[i][0]);
            }
        }
        return movies;
    }

    // Function to get data for selected movies
    function getMoviesData(data, movies) {
        return data.filter(item => movies.includes(item[0]));
    }

    // Function to extract unique genres from the movie data
    function getUniqueGenres(data) {
        var genres = [];
        for (var i = 0; i < data.length; i++) {
            var movieGenres = data[i][1].split('|');
            for (var j = 0; j < movieGenres.length; j++) {
                if (!genres.includes(movieGenres[j])) {
                    genres.push(movieGenres[j]);
                }
            }
        }
        return genres;
    }

    // Function to get movies based on the selected genre
    function getMoviesByGenre(data, genre) {
        var movies = [];
        for (var i = 0; i < data.length; i++) {
            var movieGenres = data[i][1].split('|');
            if (movieGenres.includes(genre)) {
                movies.push(data[i][0]);
            }
        }
        return movies;
    }
</script>

</body>
</html>
